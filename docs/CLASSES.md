# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ GIIS Signer

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∫–ª–∞—Å—Å—ã –∏ –∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### 1. CryptoProSigner

**–§–∞–π–ª:** `giis_signer/cryptopro_signer.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP —á–µ—Ä–µ–∑ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__(thumbprint: Optional[str], subject_name: Optional[str])` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–∏—Å–∫–æ–º –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É –∏–ª–∏ —Å—É–±—ä–µ–∫—Ç—É
- `find_certificate()` - –ø–æ–∏—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Windows
- `compute_hash(data: bytes) -> str` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–µ—à–∞ –ì–û–°–¢ –† 34.11-2012 (256 –±–∏—Ç) –≤ Base64
- `sign_data(data: bytes) -> str` - –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ì–û–°–¢ –† 34.10-2012 (256 –±–∏—Ç)
- `get_certificate_base64() -> str` - —ç–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ Base64
- `get_signature_algorithm_uri() -> str` - –ø–æ–ª—É—á–µ–Ω–∏–µ URI –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–¥–ø–∏—Å–∏
- `get_digest_algorithm_uri() -> str` - –ø–æ–ª—É—á–µ–Ω–∏–µ URI –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- `CAPICOM_CURRENT_USER_STORE = 2` - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `CAPICOM_STORE_OPEN_READ_ONLY = 0` - —Ä–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
- `CAPICOM_MY_STORE = "My"` - –ª–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- `CAPICOM_CERTIFICATE_FIND_SHA1_HASH = 0` - –ø–æ–∏—Å–∫ –ø–æ SHA1
- `CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME = 1` - –ø–æ–∏—Å–∫ –ø–æ —Å—É–±—ä–µ–∫—Ç—É
- `CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256 = 101` - –ì–û–°–¢ —Ö–µ—à 256 –±–∏—Ç
- `CADESCOM_BASE64_TO_BINARY = 1` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Base64 –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `win32com.client` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å COM-–æ–±—ä–µ–∫—Ç–∞–º–∏
- `base64` - –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è Base64

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `CryptoProException` - –±–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ

---

### 2. XMLSigner

**–§–∞–π–ª:** `giis_signer/xml_signer.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ XML-–ø–æ–¥–ø–∏—Å–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ XMLDSig —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π ExcC14N –∏ SMEV.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__(signer: CryptoProSigner)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º CryptoProSigner
- `sign_element(xml_string: str, element_id: str) -> str` - –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ XML-—ç–ª–µ–º–µ–Ω—Ç–∞
- `sign_soap_request(soap_xml: str, element_id: str, signature_element_name: str) -> str` - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è SOAP
- `insert_signature_into_soap(soap_xml: str, signature_xml: str, signature_element_name: str) -> str` - –≤—Å—Ç–∞–≤–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `_find_element_by_id(root: ET.Element, element_id: str) -> Optional[ET.Element]` - –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –∞—Ç—Ä–∏–±—É—Ç—É id
- `_create_signed_info(reference_uri: str, digest_value: str, signature_method: str, digest_method: str, include_xmlns: bool) -> str` - —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ SignedInfo
- `_create_signature(signed_info: str, signature_value: str, certificate: str) -> str` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ Signature
- `_find_element_by_local_name(root: ET.Element, local_name: str) -> Optional[ET.Element]` - –ø–æ–∏—Å–∫ –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∏–º–µ–Ω–∏ –±–µ–∑ namespace

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- `DS_NAMESPACE = "http://www.w3.org/2000/09/xmldsig#"` - –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω XMLDSig

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `xml.etree.ElementTree` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML
- `xmlcanon` - –¥–ª—è ExcC14N –∫–∞–Ω–æ–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏–∏
- `smev_transform` - –¥–ª—è SMEV-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
- `CryptoProSigner` - –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `XMLSignerException` - –±–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è:**
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ ID
2. ExcC14N –∫–∞–Ω–æ–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏—è
3. SMEV-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
4. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ DigestValue (Base64)
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ SignedInfo —Å xmlns:ds
6. –ö–∞–Ω–æ–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏—è SignedInfo
7. –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ SignedInfo
8. –†–µ–≤–µ—Ä—Å –ø–æ–¥–ø–∏—Å–∏
9. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Signature
10. –í—Å—Ç–∞–≤–∫–∞ –≤ SOAP

---

### 3. SignatureChecker

**–§–∞–π–ª:** `giis_signer/diagnostics.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ XML-–ø–æ–¥–ø–∏—Å–µ–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__(xml_file: str)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø—É—Ç–µ–º –∫ XML-—Ñ–∞–π–ª—É
- `check(verbose: bool = False) -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
- `check_structure() -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ–¥–ø–∏—Å–∏
- `check_digest() -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ DigestValue
- `extract_signature_info() -> dict` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∏

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ç–æ–¥—ã:**
- `_find_signature_element()` - –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ ds:Signature
- `_extract_digest_value()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ DigestValue
- `_extract_reference_uri()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URI —Å—Å—ã–ª–∫–∏
- `_find_signed_element()` - –ø–æ–∏—Å–∫ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `xml.etree.ElementTree` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML
- `xmlcanon` - –¥–ª—è –∫–∞–Ω–æ–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏–∏
- `smev_transform` - –¥–ª—è SMEV-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### diagnostics.py

**–§—É–Ω–∫—Ü–∏–∏:**
- `check_cryptopro_available() -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP
- `list_certificates()` - –≤—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- `check_signature(xml_file: str, verbose: bool = False) -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ XML-–ø–æ–¥–ø–∏—Å–∏

---

## CLI –º–æ–¥—É–ª—å

### cli.py

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è XML-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**–§—É–Ω–∫—Ü–∏–∏:**
- `extract_element_id(xml_content: str) -> Optional[str]` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ Element ID –∏–∑ XML –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
- `main()` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ CLI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:**
- `input` - –ø—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É XML-—Ñ–∞–π–ª—É
- `-o, --output` - –ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
- `-t, --thumbprint` - –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `-s, --subject` - –∏–º—è —Å—É–±—ä–µ–∫—Ç–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `-e, --element-id` - ID —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è (–∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–ª–∏ "body")
- `-n, --signature-element` - –∏–º—è —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –ø–æ–¥–ø–∏—Å–∏

**–õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Element ID:**
1. –ï—Å–ª–∏ `-e` –Ω–µ —É–∫–∞–∑–∞–Ω, –ø—Ä–æ–±—É–µ–º –∏–∑–≤–ª–µ—á—å –∏–∑ XML –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É `<ns:RequestData id="..."`
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∏ –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ "body"
4. –ï—Å–ª–∏ `-e` —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `argparse` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- `re` - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è Element ID
- `CryptoProSigner` - –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
- `XMLSigner` - –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è XML-–ø–æ–¥–ø–∏—Å–∏

---

## GUI –º–æ–¥—É–ª—å

### 4. GIISSignerApp

**–§–∞–π–ª:** `giis_signer/gui/app.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ GUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è XML –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `_create_widgets()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `_select_certificate()` - –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –≤—ã–±–æ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `_load_last_certificate()` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `_extract_element_id(xml_content: str) -> Optional[str]` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ Element ID –∏–∑ XML –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
- `_on_element_id_changed(event=None)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—è Element ID (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- `_refresh_element_id()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Element ID –∏–∑ XML –ø–æ –∫–Ω–æ–ø–∫–µ
- `_on_input_text_changed(event=None)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Element ID
- `_import_file()` - –∏–º–ø–æ—Ä—Ç XML —Ñ–∞–π–ª–∞
- `_export_file()` - —ç–∫—Å–ø–æ—Ä—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ XML
- `_copy_output()` - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
- `_clear_input()` - –æ—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–æ–ª—è –∏ Element ID
- `_clear_output()` - –æ—á–∏—Å—Ç–∫–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –ø–æ–ª—è
- `_clear_all()` - –æ—á–∏—Å—Ç–∫–∞ –æ–±–æ–∏—Ö –ø–æ–ª–µ–π
- `_sign_xml()` - –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ XML –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Element ID
- `_toggle_theme()` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- `_on_closing()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –§—Ä–µ–π–º –≤—ã–±–æ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –≤—Ö–æ–¥–Ω–æ–π XML:
  - –ü–æ–ª–µ –≤–≤–æ–¥–∞ Element ID (—Å –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º) + –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è üîÑ
  - –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è XML
  - –ö–Ω–æ–ø–∫–∏ –∏–º–ø–æ—Ä—Ç–∞/–æ—á–∏—Å—Ç–∫–∏
- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π XML (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ + –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞/–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–æ—á–∏—Å—Ç–∫–∏)
- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å - –∫–Ω–æ–ø–∫–∏ "–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë" –∏ "–ü–æ–¥–ø–∏—Å–∞—Ç—å"

**–õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Element ID:**
1. –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∏—â–µ—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω `<ns:RequestData id="..."`
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ Element ID
3. –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è üîÑ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ (—Å–µ—Ä–∞—è)
4. –ü—Ä–∏ —Ä—É—á–Ω–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—è Element ID:
   - –ï—Å–ª–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å Element ID –∏–∑ XML ‚Üí –∫–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π (—Å–µ—Ä–∞—è)
   - –ï—Å–ª–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ‚Üí –∫–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è (–∑–µ–ª–µ–Ω–∞—è)
5. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É - Element ID –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑ XML, –∫–Ω–æ–ø–∫–∞ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π
6. –ü—Ä–∏ –æ—á–∏—Å—Ç–∫–µ/–∏–º–ø–æ—Ä—Ç–µ - –∫–Ω–æ–ø–∫–∞ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
7. –ü—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—è –∏–ª–∏ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ "body"

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `customtkinter` - –¥–ª—è GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `CryptoProSigner`, `XMLSigner` - –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
- `CertificateDialog` - –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `CertificateManager` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- `Config` - –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

### 5. CertificateDialog

**–§–∞–π–ª:** `giis_signer/gui/certificate_dialog.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__(parent, certificate_manager)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–∞
- `_create_widgets()` - —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `_load_certificates()` - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- `_add_certificate_item(cert)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ —Å–ø–∏—Å–æ–∫
- `_on_certificate_selected(cert)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `_refresh_certificates()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- `_on_select()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–í—ã–±—Ä–∞—Ç—å"
- `_on_cancel()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∞"
- `get_selected_certificate()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–∏–∞–ª–æ–≥–∞
- –°–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º—ã–π —Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (—Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏)
- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ
- –ö–Ω–æ–ø–∫–∏ "–û–±–Ω–æ–≤–∏—Ç—å", "–í—ã–±—Ä–∞—Ç—å", "–û—Ç–º–µ–Ω–∞"

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `customtkinter` - –¥–ª—è GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `CertificateManager` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

---

### 6. CertificateManager

**–§–∞–π–ª:** `giis_signer/gui/certificate_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –¥–ª—è GUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- `get_certificates(refresh: bool = False) -> List[CertificateInfo]` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- `find_certificate_by_thumbprint(thumbprint: str) -> Optional[CertificateInfo]` - –ø–æ–∏—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É
- `_format_date(date_value) -> str` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
- `_check_validity(cert) -> bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- `CAPICOM_CURRENT_USER_STORE = 2`
- `CAPICOM_STORE_OPEN_READ_ONLY = 0`
- `CAPICOM_MY_STORE = "My"`

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `win32com.client` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å COM-–æ–±—ä–µ–∫—Ç–∞–º–∏
- `CertificateInfo` - dataclass –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ

---

### 7. CertificateInfo (dataclass)

**–§–∞–π–ª:** `giis_signer/gui/certificate_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ.

**–ü–æ–ª—è:**
- `thumbprint: str` - –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- `subject_name: str` - –∏–º—è —Å—É–±—ä–µ–∫—Ç–∞
- `issuer_name: str` - –∏–º—è –∏–∑–¥–∞—Ç–µ–ª—è
- `valid_from: str` - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è
- `valid_to: str` - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è
- `serial_number: str` - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
- `is_valid: bool` - —Ñ–ª–∞–≥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `get_display_name() -> str` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏ (CN + –ø–æ—Å–ª–µ–¥–Ω–∏–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ thumbprint)
- `get_tooltip() -> str` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- `_extract_cn(subject: str) -> str` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ CN –∏–∑ subject —Å—Ç—Ä–æ–∫–∏

---

### 8. Toast –∏ ToastManager

**–§–∞–π–ª:** `giis_signer/gui/toast.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Å—Ç–∏–ª–µ push-notifications.

#### Toast (–∫–ª–∞—Å—Å)

**–ú–µ—Ç–æ–¥—ã:**
- `__init__(parent, message: str, duration: int, type: Literal["success", "info", "warning", "error"])` - —Å–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `show(x: int, y: int)` - –ø–æ–∫–∞–∑–∞—Ç—å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- `hide()` - —Å–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
- `success` - –∑–µ–ª–µ–Ω–æ–µ (‚úÖ) - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `info` - —Å–∏–Ω–µ–µ (‚ÑπÔ∏è) - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `warning` - –∂–µ–ª—Ç–æ–µ (‚ö†Ô∏è) - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `error` - –∫—Ä–∞—Å–Ω–æ–µ (‚ùå) - –æ—à–∏–±–∫–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `duration` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3000)
- `message` - —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `type` - —Ç–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### ToastManager (–∫–ª–∞—Å—Å)

**–ú–µ—Ç–æ–¥—ã:**
- `__init__(parent)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- `show(message: str, type: str, duration: int)` - –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `success(message: str, duration: int = 3000)` - –ø–æ–∫–∞–∑–∞—Ç—å success-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `info(message: str, duration: int = 3000)` - –ø–æ–∫–∞–∑–∞—Ç—å info-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `warning(message: str, duration: int = 3000)` - –ø–æ–∫–∞–∑–∞—Ç—å warning-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `error(message: str, duration: int = 3000)` - –ø–æ–∫–∞–∑–∞—Ç—å error-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:**
- `success` - —è—Ä–∫–∏–π –∑–µ–ª–µ–Ω—ã–π (#28a745) —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º
- `info` - —è—Ä–∫–∏–π –≥–æ–ª—É–±–æ–π (#17a2b8) —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º
- `warning` - —è—Ä–∫–∏–π –∂–µ–ª—Ç—ã–π (#ffc107) —Å —Ç–µ–º–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º (#212529)
- `error` - —è—Ä–∫–∏–π –∫—Ä–∞—Å–Ω—ã–π (#dc3545) —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–Ω–∏ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ (—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)
- –ú–∞–∫—Å–∏–º—É–º 3 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ù–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–≤–µ—Ä—Ö—É, —Å—Ç–∞—Ä–æ–µ –∏—Å—á–µ–∑–∞–µ—Ç —Å–Ω–∏–∑—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
- –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ - –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏

---

### 9. Config

**–§–∞–π–ª:** `giis_signer/gui/config.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π GUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `__init__(app_name: str = "giis-signer")` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `load()` - –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞
- `save()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ñ–∞–π–ª
- `get(key: str, default: Any = None) -> Any` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–ª—é—á—É
- `set(key: str, value: Any)` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
- `get_last_certificate_thumbprint() -> Optional[str]`
- `set_last_certificate_thumbprint(thumbprint: str)`
- `get_window_geometry() -> Optional[str]`
- `set_window_geometry(geometry: str)`
- `get_theme() -> str`
- `set_theme(theme: str)`
- `get_last_input_dir() -> Optional[str]`
- `set_last_input_dir(directory: str)`
- `get_last_output_dir() -> Optional[str]`
- `set_last_output_dir(directory: str)`
- `clear()` - –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
- Windows: `%APPDATA%/giis-signer/config.json`
- Linux/macOS: `~/.config/giis-signer/config.json`

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `json` - –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `pathlib.Path` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏

---

## –ò—Å–∫–ª—é—á–µ–Ω–∏—è

### CryptoProException
**–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å:** `Exception`
**–ú–æ–¥—É–ª—å:** `cryptopro_signer.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP

### XMLSignerException
**–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å:** `Exception`
**–ú–æ–¥—É–ª—å:** `xml_signer.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—à–∏–±–∫–∏ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ XML-–ø–æ–¥–ø–∏—Å–∏

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```
cli.py
  ‚îî‚îÄ‚îÄ CryptoProSigner (cryptopro_signer.py)
  ‚îî‚îÄ‚îÄ XMLSigner (xml_signer.py)
        ‚îú‚îÄ‚îÄ CryptoProSigner
        ‚îú‚îÄ‚îÄ xmlcanon (–≤–Ω–µ—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
        ‚îî‚îÄ‚îÄ smev_transform (–≤–Ω–µ—à–Ω–∏–π –ø–∞–∫–µ—Ç)

diagnostics.py
  ‚îú‚îÄ‚îÄ SignatureChecker
  ‚îÇ     ‚îú‚îÄ‚îÄ xmlcanon
  ‚îÇ     ‚îî‚îÄ‚îÄ smev_transform
  ‚îî‚îÄ‚îÄ CryptoProSigner (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ)

__init__.py
  ‚îú‚îÄ‚îÄ CryptoProSigner
  ‚îú‚îÄ‚îÄ XMLSigner
  ‚îî‚îÄ‚îÄ diagnostics (–≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏)
```

---

## –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python
- `pywin32>=305` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º Windows
- `lxml>=4.9.0` - –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ XML
- `xmlcanon>=1.0.0` - –¥–ª—è ExcC14N –∫–∞–Ω–æ–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏–∏
- `smev-transform>=2.0.0` - –¥–ª—è SMEV-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP 4.0+** - –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ì–û–°–¢
- **Windows OS** - –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-01
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 1.0.0
