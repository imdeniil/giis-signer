# Changelog

Все значимые изменения проекта GIIS Signer документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
и проект следует [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added
- ✅ GUI приложение с интерфейсом на CustomTkinter
- ✅ Диалог выбора сертификата с подробной информацией
- ✅ Функционал импорта/экспорта XML файлов
- ✅ Кнопки очистки текстовых полей (по отдельности и вместе)
- ✅ Сохранение выбранного сертификата между сессиями
- ✅ Сохранение размера и позиции окна
- ✅ Поддержка темной и светлой темы
- ✅ Entry point `giis-signer-gui` для запуска GUI приложения
- ✅ Поле для указания Element ID с авто-определением из XML
- ✅ Динамическое извлечение Element ID по паттерну `<ns:RequestData id="...">`
- ✅ Возможность ручной корректировки Element ID перед подписанием
- ✅ Кнопка обновления Element ID (активируется только при изменении, отличающемся от XML)
- ✅ Toast-уведомления (неблокирующие push-уведомления вместо модальных диалогов)
- ✅ Четыре типа toast-уведомлений: success (зеленые), info (голубые), warning (желтые), error (красные)
- ✅ Автоматическое исчезновение уведомлений (3 секунды для обычных, 5 для ошибок)
- ✅ Ограничение на 3 уведомления одновременно (новые сверху, старые исчезают снизу)
- ✅ Яркие и контрастные цвета для лучшей видимости

### Changed
- Модуль SMEV трансформации вынесен в отдельный пакет `smev-transform>=2.0.0`
- Обновлены зависимости проекта для использования внешнего пакета smev-transform
- Упрощена структура пакета giis_signer
- Добавлена зависимость `customtkinter>=5.2.0`
- CLI: Element ID теперь авто-определяется из XML, если не указан явно через `-e`
- CLI: Обновлен параметр `--element-id` для поддержки авто-определения

### Fixed
- ✅ Исправлены импорты в модуле diagnostics.py для работы с внешним пакетом smev-transform
- ✅ Заменен `exc_c14n.transform.transform_exc_c14n` на `xmlcanon.canonicalize_xml`

## [1.0.0] - 2025-10-01

### Added
- ✅ Полная реализация подписания XML по стандарту XMLDSig для ГИИС ДМДК
- ✅ Интеграция с КриптоПро CSP через COM-интерфейс
- ✅ Поддержка ГОСТ Р 34.10-2012 (256 бит) для подписи
- ✅ Поддержка ГОСТ Р 34.11-2012 (256 бит) для хеширования
- ✅ Реализация Exclusive Canonicalization (ExcC14N)
- ✅ Поддержка SMEV-трансформации для госсистем
- ✅ CLI-интерфейс через команду `giis-signer`
- ✅ Программный API для использования как библиотеки
- ✅ Модуль диагностики для проверки КриптоПро и подписей
- ✅ Полная документация проекта
- ✅ Примеры использования (template.xml, example_rq_1c.xml)

### Fixed
- ✅ Исправлена ошибка с DigestValue (конвертация HEX → Base64)
- ✅ Исправлена проблема с самозакрывающимися тегами в SignedInfo
- ✅ Исправлена проблема с форматированием подписи (отключено для сохранения целостности)
- ✅ Добавлен обязательный реверс подписи для совместимости с КриптоПро CSP
- ✅ Исправлена проблема с поиском сертификатов (нормализация thumbprint)

## [0.1.0] - Начало разработки

### Added
- Первоначальная реализация базового функционала
- Начальная версия модулей cryptopro_signer.py и xml_signer.py

### Known Issues
- ⚠️ Проблемы с форматированием XML нарушали подпись
- ⚠️ DigestValue в неправильном формате (HEX вместо Base64)
- ⚠️ Ошибки при работе с COM-объектами КриптоПро

---

[Unreleased]: https://github.com/yourusername/giis-signer/compare/v1.0.0...HEAD
[1.0.0]: https://github.com/yourusername/giis-signer/releases/tag/v1.0.0
[0.1.0]: https://github.com/yourusername/giis-signer/releases/tag/v0.1.0
